name: Automated Scraper (DISABLED)

# Temporarily disabled due to Sherdog 403 blocking
# To re-enable: uncomment the schedule section below
on:
  # schedule:
  #   - cron: '0 */4 * * *'
  workflow_dispatch: # Keep manual trigger available

jobs:
  run-scraper:
    runs-on: ubuntu-latest
    timeout-minutes: 20
    permissions:
      contents: read
    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Build scraper container
        run: docker build -t finish-finder-scraper .

      - name: Run automated scraper
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
          SCRAPER_CANCEL_THRESHOLD: ${{ vars.SCRAPER_CANCEL_THRESHOLD }}
          SCRAPER_FIGHT_CANCEL_THRESHOLD: ${{ vars.SCRAPER_FIGHT_CANCEL_THRESHOLD }}
          SENTRY_DSN: ${{ secrets.SENTRY_DSN }}
          NEXT_PUBLIC_SENTRY_DSN: ${{ secrets.NEXT_PUBLIC_SENTRY_DSN }}
        run: |
          docker run --rm \
            -e OPENAI_API_KEY \
            -e DATABASE_URL \
            -e SCRAPER_CANCEL_THRESHOLD \
            -e SCRAPER_FIGHT_CANCEL_THRESHOLD \
            -e SENTRY_DSN \
            -e NEXT_PUBLIC_SENTRY_DSN \
            finish-finder-scraper
